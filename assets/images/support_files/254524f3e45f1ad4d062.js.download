(window.webpackJsonp=window.webpackJsonp||[]).push([[345],{1985:function(e,a,r){"use strict";r.d(a,"a",(function(){return t})),r.d(a,"b",(function(){return n})),r.d(a,"c",(function(){return o})),r.d(a,"e",(function(){return i})),r.d(a,"f",(function(){return c})),r.d(a,"d",(function(){return d}));var t=function(e){return e.reverseImageSearch.isLoading},n=function(e){return e.reverseImageSearch.isRisDialogOpen},o=function(e){return e.reverseImageSearch.shouldCloseOnDragLeave},i=function(e){return e.reverseImageSearch.uploadError},c=function(e){var a;return null===(a=e.reverseImageSearch)||void 0===a?void 0:a.uploadImageSrc},d=function(e){return e.location.siteIdentifier}},2006:function(e,a,r){"use strict";r.r(a);var t,n,o=r(3),i=r(1984),c=r(2),d=r(16),l=r(15),s=(t={},Object(c.a)(t,d.k.video,"videos"),Object(c.a)(t,d.k.image,"images"),t),u=(n={},Object(c.a)(n,d.k.video,l.a.footage.searchRis),Object(c.a)(n,d.k.image,"route/IMAGE/SEARCH_RIS"),n),g={isLoading:!1,isRisDialogOpen:!1,shouldCloseOnDragLeave:!1,uploadError:"",uploadImageSrc:{}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(a.type){case i.g.CLEAR_UPLOAD_ERROR:return Object(o.a)({},e,{uploadError:""});case i.g.SET_DEFAULT_STATE:return Object(o.a)({},e,g);case i.g.SET_LOADING:return Object(o.a)({},e,{isLoading:!0});case i.g.SET_UPLOAD_ERROR:return Object(o.a)({},e,{uploadError:a.errType});case i.g.SET_UPLOAD_IMAGE_SRC:return Object(o.a)({},e,{uploadImageSrc:a.uploadImageSrc});case i.g.TOGGLE_RIS_DIALOG:return Object(o.a)({},e,{isRisDialogOpen:!e.isRisDialogOpen,shouldCloseOnDragLeave:a.shouldCloseOnDragLeave||!1,uploadError:""});case i.g.UPLOAD_IMAGE_FAILED:return Object(o.a)({},e,{isLoading:!1,uploadError:"generic"});default:return e}},p=r(4),h=r.n(p),m=r(13),f=r(1),b=r(87),O=r(1985),D=h.a.mark(N),v=h.a.mark(E);function j(e){return Object.entries(e).reduce((function(e,a){var r=Object(m.a)(a,2),t=r[0],n=r[1];return"content-type"!==t.toLowerCase()&&(e[t]=n),e}),{})}function N(e){var a,r,t,n,o,c;return h.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return a=e.data,l.next=3,Object(f.i)(Object(i.b)());case 3:return l.next=5,Object(f.k)(O.d);case 5:return r=l.sent,t=s[r]||s[d.k.image],l.prev=7,l.next=10,Object(f.c)(d.h,"/".concat(t,"/reverse-image-search"),{method:"POST",body:a,stringifyBody:!1,timeout:1e4,transformHeaders:j});case 10:if(!(n=l.sent).errors){l.next=18;break}return o=Array.isArray(n.errors)?n.errors[0].detail:"unknown",l.next=15,Object(f.c)(b.b.error,"Reverse image search: Studio API upload responded with ".concat(o));case 15:return l.next=17,Object(f.i)(Object(i.i)());case 17:return l.abrupt("return");case 18:return l.next=20,n.map((function(e){return e.id})).join(",");case 20:return c=l.sent,l.next=23,Object(f.i)({type:u[r]||u[d.k.image],payload:{queryString:c}});case 23:l.next=31;break;case 25:return l.prev=25,l.t0=l.catch(7),l.next=29,Object(f.c)(b.b.error,"Reverse image search: Studio API upload failed.  Error details: ",l.t0);case 29:return l.next=31,Object(f.i)(Object(i.i)());case 31:case"end":return l.stop()}}),D,this,[[7,25]])}function E(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.o)(i.g.UPLOAD_IMAGE,N);case 2:case"end":return e.stop()}}),v,this)}var w=r(19),S=r(5),x=r(18),k=r(30),y=r(77),I=r(14),A=r(21),T=r(27),R=r(26),L=r(25),C=r(29),B=r(8),U=r(0),P=r.n(U),G=r(9),F=r.n(G),H=r(45),z=r(35),M=r(2634),J=r(2564),q=r(5721),W=r.n(q),V={upload:"SearchBar_reverse_image_search_upload_Button",cancel:"SearchBar_reverse_image_search_cancel_Button",close:"SearchBar_reverse_image_search_close_Button"},K=function(e){function a(){var e,r;Object(A.a)(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return r=Object(R.a)(this,(e=Object(L.a)(a)).call.apply(e,[this].concat(n))),Object(c.a)(Object(B.a)(Object(B.a)(r)),"handleValidation",(function(e){return Array.from(e).find((function(e){return["image/jpg","image/jpeg","image/png"].includes(e.type)&&e.size<5e6}))})),Object(c.a)(Object(B.a)(Object(B.a)(r)),"handleThumb",(function(e){var a=e.width/e.height,t=Math.round(90*a),n=document.createElement("canvas");n.width=t,n.height=90,n.getContext("2d").drawImage(e,0,0,t,90),r.props.setUploadImageSrc({aspect:a,src:n.toDataURL("image/png",1),thumbWidth:t})})),Object(c.a)(Object(B.a)(Object(B.a)(r)),"handleFiles",(function(e){var a=e.files;if(r.props.clearUploadError(),a.length){var t=r.handleValidation(a);if(t&&"undefined"!=typeof window){var n=new window.FileReader;n.onload=function(){var e=new window.Image;e.onload=function(){r.handleThumb(e)},e.src=n.result},n.readAsDataURL(t);var o=new window.FormData;o.append("image",t),r.props.uploadImage(o)}else r.props.setUploadError(["image/jpg","image/jpeg","image/png"].includes(a[0].type)?"size":"format")}else r.props.setUploadError()})),r}return Object(C.a)(a,e),Object(T.a)(a,[{key:"render",value:function(){var e=this.props,a=e.cancel,r=e.dragAndDrop,t=e.dropAnywhere,n=e.isFloating,o=e.isRisDialogOpen,i=e.orUpload,c=e.showSearchByImageButton,d=e.toggleRisDialog,l=e.uploadError,s=e.risButtonLabel;return P.a.createElement("div",{className:F()(W.a.root)},c&&P.a.createElement(H.a,{size:"large",onClick:d,"data-track-action":"click","data-track-section":"searchBar","data-track-label":"reverseImageSearchButton","data-automation":"SearchBar_reverse_image_search_Button","aria-label":s,className:F()(W.a.button,n&&W.a.isFloating)},P.a.createElement(z.a,{alt:s,value:"search-by-image",theme:{icon:W.a.icon}}),s),d&&P.a.createElement(M.a,Object(I.a)({},this.props,{uploadError:!!l,toggleDialog:d,isDialogOpen:o,processDrop:this.handleFiles,dataTrackSection:"reverseImageSearchDialog",dataAutomation:V}),P.a.createElement(J.a,{upload:i,ctaTitle:r,ctaDragTitle:t,cancel:a,dataTrackSection:"reverseImageSearchDialog",dataAutomation:V,icon:"search-by-image"})))}}]),a}(U.Component);Object(c.a)(K,"defaultProps",{showSearchByImageButton:!0});var Q=K,X=r(5720),Y=Object(S.createSelector)(O.e,(function(e){return e?"search:ris_error_text_".concat(e):"search:ris_error_text_generic"})),Z={clearUploadError:i.a,setUploadError:i.d,setUploadImageSrc:i.e,toggleRisDialog:i.f,uploadImage:i.h},$=Object(w.a)(Object(k.g)(Object(o.a)({},X,y.a)),Object(x.connect)((function(e,a){var r=a.t,t=Object(O.d)(e),n=t!==d.k.image?"_".concat(t):"";return{cancel:r("common:actions_cancel"),close:r("common:actions_close"),dragAndDrop:r("search:ris_drag_and_drop"),dropAnywhere:r("search:ris_drop_anywhere"),isLoading:Object(O.a)(e),isRisDialogOpen:Object(O.b)(e),loadingHelpText:r("search:ris_loading_help_text".concat(n)),orUpload:r("search:ris_or_upload"),shouldCloseOnDragLeave:Object(O.c)(e),supportedHelpText:r("search:ris_supported_help_text"),tooltipText:r("search:ris_tooltip_text".concat(n)),uploadError:Object(O.e)(e),errorText:r(Y(e))}}),Z))(Q);r.d(a,"register",(function(){return ee})),r.d(a,"default",(function(){return $}));var ee=function(e){var a=e.registerReducer,r=e.registerWatchers;a("reverseImageSearch",_),r(E)}},2564:function(e,a,r){"use strict";var t=r(0),n=r.n(t),o=r(45),i=r(35),c=r(9),d=r.n(c),l=r(2650),s=r.n(l),u=function(e){var a=e.upload,r=e.cancel,t=e.ctaTitle,c=e.ctaDragTitle,l=e.isADrag,u=e.toggleDialog,g=e.uploadHandler,_=e.dataTrackSection,p=e.dataAutomation,h=e.icon,m=e.theme,f=n.a.createRef();return n.a.createElement("div",{className:d()(s.a.dddDialogContainer,m.cta)},n.a.createElement(i.a,{className:d()(s.a.dddDialogIcon,m.icon),value:h}),n.a.createElement("div",{className:d()(s.a.dddDialogHelpText,m.ctaTitle,l&&s.a.displayNone)},t),n.a.createElement("div",{className:d()(s.a.dddDialogHelpText,!l&&s.a.displayNone)},c),a&&n.a.createElement(o.a,{size:"small",disabled:l,label:a,className:"",onClick:function(){return f.current.click()},"data-track-action":"click","data-track-section":_,"data-track-label":"upload","data-automation":p.upload}),n.a.createElement("br",null),n.a.createElement("input",{type:"file",accept:".png, .jpg, .jpeg",ref:f,className:d()(s.a.displayNone),onChange:function(e){return g({e:e,files:e.target.files})}}),r&&n.a.createElement(o.a,{size:"small",disabled:l,neutral:!1,label:r,onClick:u,"data-track-action":"click","data-track-section":_,"data-track-label":"cancel","data-automation":p.cancel}))};u.defaultProps={upload:"upload",cancel:null,ctaTitle:"Drag and Drop an Image",ctaDragTitle:"Drop Anywhere",isADrag:!1,toggleDialog:function(){},uploadHandler:function(){},icon:"",dataTrackSection:"",dataAutomation:{upload:"",cancel:""},theme:{cta:"",ctaTitle:"",icon:""}},a.a=u},2634:function(e,a,r){"use strict";(function(e){r.d(a,"a",(function(){return d}));var t=r(6),n=r.n(t),o=r(7),i=r.n(o),c=r(161),d=Object(c.c)("DragDropDialog",(function(){return i()({id:"./DragDropDialog",load:function(){return Promise.all([r.e(330).then(r.bind(null,2655))]).then((function(e){return e[0]}))},path:function(){return n.a.join(e,"./DragDropDialog")},resolve:function(){return 2655},chunkName:function(){return"DragDropDialog"}})}),{loading:null})}).call(this,"/")},2650:function(e,a,r){e.exports={"display-none":"N_a_9b892",displayNone:"N_a_9b892",label:"N_a_4dc52","ddd-dialog":"N_a_84455",dddDialog:"N_a_84455","ddd-dialog-content":"N_a_07ef8",dddDialogContent:"N_a_07ef8","main-content-container":"N_a_bf12c",mainContentContainer:"N_a_bf12c","close-button":"N_a_7e80d",closeButton:"N_a_7e80d","ddd-dialog-drop-area":"N_a_a2ec7",dddDialogDropArea:"N_a_a2ec7","ddd-dialog-drop-mask":"N_a_645c0",dddDialogDropMask:"N_a_645c0","ddd-dialog-pulse":"N_a_e7bc4",dddDialogPulse:"N_a_e7bc4",changePadding:"N_a_46a46","ddd-dialog-border":"N_a_52d3f",dddDialogBorder:"N_a_52d3f","ddd-dialog-close-btn":"N_a_07b59",dddDialogCloseBtn:"N_a_07b59","ddd-dialog-container":"N_a_038d2",dddDialogContainer:"N_a_038d2","ddd-dialog-icon":"N_a_61bf5",dddDialogIcon:"N_a_61bf5","ddd-dialog-help-text":"N_a_3fd6a",dddDialogHelpText:"N_a_3fd6a","ddd-dialog-error-text":"N_a_d5f9d",dddDialogErrorText:"N_a_d5f9d","ddd-dialog-file-requirements":"N_a_93b73 font-body-static-sm",dddDialogFileRequirements:"N_a_93b73 font-body-static-sm"}},5720:function(e){e.exports=JSON.parse('{"search:ris_drag_and_drop":"Drag and drop an image to find similar","search:ris_drop_anywhere":"Drop anywhere to find similar","search:ris_error_text_generic":"Something went wrong! Please try again.","search:ris_error_text_format":"Something went wrong! Check the file format and try again.","search:ris_error_text_size":"Something went wrong! Check the file size and try again.","search:ris_loading_help_text":"Finding similar images","search:ris_loading_help_text_video":"Finding similar videos","search:ris_or_upload":"Or, upload","search:ris_supported_help_text":"We only support JPG and PNG images under 5MB.","search:ris_tooltip_text":"Search with an image instead of text to discover similar images.","search:ris_tooltip_text_video":"Search with an image instead of text to discover similar videos."}')},5721:function(e,a,r){e.exports={root:"G_a_63359",button:"G_a_b4b4c","is-floating":"G_a_2354f",isFloating:"G_a_2354f",icon:"G_a_4560b"}}}]);
//# sourceMappingURL=254524f3e45f1ad4d062.js.map